FROM simonsdave/bionic-dev-env:%DEV_ENV_VERSION%

MAINTAINER Dave Simons

ENV DEBIAN_FRONTEND noninteractive

RUN apt-get update -y
# this list came from https://hub.docker.com/r/aaron465/matplotlib/dockerfile
RUN apt-get install -y libxft-dev libfreetype6 libfreetype6-dev

RUN mkdir /tmp/package
ADD package.tar.gz /tmp/package/.

RUN cd /tmp/package && pip3 install --requirement "requirements.txt"

# as per http://stackoverflow.com/questions/29073802/matplotlib-cannot-find-configuration-file-matplotlibrc
RUN mkdir -p /root/.config/matplotlib
ADD /tmp/package/matplotlibrc /root/.config/matplotlib/matplotlibrc
RUN chown --recursive root:root /root/.config

RUN rm -rf "/tmp/package"

ENV DEBIAN_FRONTEND newt

ENV PATH "/app/bin:${PATH}"
ENV PYTHONPATH /app

WORKDIR /app
